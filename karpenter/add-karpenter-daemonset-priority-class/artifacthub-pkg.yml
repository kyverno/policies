name: add-karpenter-daemonset-priority-class
version: 1.0.0
displayName: Add priority class for DaemonSets to help Karpenter
createdAt: "2023-06-01T16:55:10.000Z"
description: >-
  When a DaemonSet is added to a cluster every node will get a new pod. There may not be 
  enough room for this on every node. Karpenter cannot provision extra nodes just for the 
  DaemonSet because the new pods are not scheduled the way regular pods are. It would require
  parallel scheduling logic that is not proper to Kubernetes. Therefore, eviction of regular 
  pods should happen instead. This can be achieved with the priority class system-node-critical.
install: |-
  ```shell
  kubectl apply -f https://raw.githubusercontent.com/kyverno/policies/main/karpenter/add-karpenter-daemonset-priority-class/add-karpenter-daemonset-priority-class.yaml
  ```
keywords:
  - kyverno
  - Karpenter
  - EKS Best Practices
readme: >-
  When a DaemonSet is added to a cluster every node will get a new pod. There may not be 
  enough room for this on every node. Karpenter cannot provision extra nodes just for the 
  DaemonSet because the new pods are not scheduled the way regular pods are. It would require
  parallel scheduling logic that is not proper to Kubernetes. Therefore, eviction of regular 
  pods should happen instead. This can be achieved with the priority class system-node-critical.
annotations:
  kyverno/category: "Karpenter, EKS Best Practices"
  kyverno/kubernetesVersion: "1.23"
  kyverno/subject: "DaemonSet"
digest: d362d0f39e827f364e3527542260994471420007e6624f4a992d8ce2963b01ac
