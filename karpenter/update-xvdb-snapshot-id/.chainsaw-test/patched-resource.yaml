apiVersion: karpenter.k8s.aws/v1beta1
kind: EC2NodeClass
metadata:
  name: test-no-mappings
spec:
  blockDeviceMappings:
  - deviceName: "/dev/xvdb"
    ebs:
      snapshotID: "snap-0123456789abcdef0"
      volumeSize: 20Gi
      volumeType: gp3
      deleteOnTermination: true
  instanceStorePolicy: RAID0
  userData: |
    #!/bin/bash
    /etc/eks/bootstrap.sh test-cluster
---
apiVersion: karpenter.k8s.aws/v1beta1
kind: EC2NodeClass
metadata:
  name: test-existing-other-mappings
spec:
  blockDeviceMappings:
  - deviceName: "/dev/xvda1"
    ebs:
      volumeSize: 100Gi
      volumeType: gp3
      deleteOnTermination: true
  - deviceName: "/dev/xvdb"
    ebs:
      snapshotID: "snap-0123456789abcdef0"
      volumeSize: 20Gi
      volumeType: gp3
      deleteOnTermination: true
  instanceStorePolicy: RAID0
  userData: |
    #!/bin/bash
    /etc/eks/bootstrap.sh test-cluster
---
apiVersion: karpenter.k8s.aws/v1beta1
kind: EC2NodeClass
metadata:
  name: test-existing-xvdb-mapping
spec:
  blockDeviceMappings:
  - deviceName: "/dev/xvda1"
    ebs:
      volumeSize: 100Gi
      volumeType: gp3
      deleteOnTermination: true
  - deviceName: "/dev/xvdb"
    ebs:
      snapshotID: "snap-0123456789abcdef0"
      volumeSize: 50Gi
      volumeType: gp2
      deleteOnTermination: true
  instanceStorePolicy: RAID0
  userData: |
    #!/bin/bash
    /etc/eks/bootstrap.sh test-cluster 