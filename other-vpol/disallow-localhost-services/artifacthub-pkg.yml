name: disallow-localhost-services-vpol
version: 1.0.0
displayName: Disallow Localhost ExternalName Services in ValidatingPolicy
description: >-
  A Service of type ExternalName which points back to localhost can potentially be used to exploit vulnerabilities in some Ingress controllers. This policy audits Services of type ExternalName if the externalName field refers to localhost.
install: |-
  ```shell
  kubectl apply -f https://raw.githubusercontent.com/kyverno/policies/main/other-vpol/disallow-localhost-services/disallow-localhost-services.yaml
  ```
keywords:
  - kyverno
  - Sample
  - ValidatingPolicy
readme: |
  A Service of type ExternalName which points back to localhost can potentially be used to exploit vulnerabilities in some Ingress controllers. This policy audits Services of type ExternalName if the externalName field refers to localhost.
  
  Refer to the documentation for more details on Kyverno annotations: https://artifacthub.io/docs/topics/annotations/kyverno/
annotations:
  kyverno/category: "Sample in Vpol"
  kyverno/kubernetesVersion: "1.30"
  kyverno/subject: "Service"
digest: a0fa1b44283e98fab50a2cd480e8bfa29aa9f1d49b93c8aa08b02fc0616b57b2


createdAt: "2025-05-11T17:46:12Z"
