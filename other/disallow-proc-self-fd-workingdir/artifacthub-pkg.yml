name: disallow-proc-self-fd-workingdir
version: 1.0.0 
displayName: Disallow workingDir with self file descriptors
createdAt: "2024-02-02T00:00:00.000Z" 
description: >-
      This policy prevents the configuration of a container workingDir with file descriptors
      that start with /proc/self/fd. This is a partial mitigation for CVE-2024-21626 aka
      Leaky Vessels Container Breakout. For additional details and mitigation please refer to
      https://snyk.io/blog/leaky-vessels-docker-runc-container-breakout-vulnerabilities/.
install: |-
    ```shell
    kubectl apply -f https://raw.githubusercontent.com/kyverno/policies/main/other/disallow-proc-self-fd-workingdir/disallow-proc-self-fd-workingdir.yaml
    ```   
keywords:
  - runc
  - CVE-2024-21626
readme: | 
  This policy prevents the configuration of a container workingDir with file descriptors
  that start with /proc/self/fd. This is a partial mitigation for CVE-2024-21626 aka
  Leaky Vessels Container Breakout. For additional details and mitigation please refer to
  https://snyk.io/blog/leaky-vessels-docker-runc-container-breakout-vulnerabilities/.

  Refer to the documentation for more details on Kyverno annotations: https://artifacthub.io/docs/topics/annotations/kyverno/
annotations: 
  kyverno/category: "Runc"
  kyverno/kubernetesVersion: "1.28"
  kyverno/subject: "Pod"
